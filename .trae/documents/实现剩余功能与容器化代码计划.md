## 待实现的具体代码
- 任务过期测试：在 `app/server/server_test.go` 新增 `TestTaskExpired`，构造 `AppServer` 时传入短 `expireAfter`（如 500ms），等待过期后提交断言错误响应为 `Task expired`。
- 客户端保底提交测试：为 `client/app.Client` 增加可配置的提交周期（秒级与“分钟”周期）构造参数；在测试里将“分钟”设置为 3s，验证 3s 窗口内至少一次提交（断言响应或统计自增）。
- 容器化：在项目根目录新增 `docker-compose.yml`（services: `postgres:15`、`rabbitmq:3-management`），默认网络与凭据；更新 README 增加容器化快速启动与环境变量配置示例（`KUP_PG_DSN`、`KUP_MQ_URL`、`KUP_MQ_QUEUE`）。
- 可观测性：在 `cmd/kupool-server/main.go` 增加可选 `-metrics_addr`（或 `KUP_METRICS_ADDR`）启动一个轻量 `http` 端点，输出文本指标：提交成功数、失败数、速率限制命中数、重复提交数（在 `app/server/listener.go` 内维护内存计数器）。
- 长时运行优化：在 `app/server/types.go` 增加 `historyWindow` 配置（默认 64）；在 `app/server/coordinator.go` 的 `rotateJob()` 中清理超出窗口的旧 `job_id`，并在会话的 `UsedNonces` 中同步清理对应条目。

## 实施步骤
1. 修改 `client/app/client.go`：新增 `type Options`，支持注入 `SecondTicker` 与 `MinuteTicker` 周期；更新 `NewClient` 支持传入；默认保持现有行为。
2. 修改 `app/server`：
   - `types.go` 增加指标结构与 `historyWindow` 字段；
   - `listener.go` 在成功/失败路径更新计数器；
   - `coordinator.go` 在 `rotateJob()` 清理旧历史与会话 nonce；
3. 新增 `cmd/kupool-server` metrics 端点：
   - 可选监听地址，输出简易文本（如 `success=X\nfailed=Y\nrate_limited=Z\nduplicates=W`）。
4. 新增/更新测试：
   - `TestTaskExpired` 与客户端保底提交测试（缩短周期）。
5. 新增 `docker-compose.yml` 与 README 容器化章节。

## 验证
- 本地：`go build ./...` 与 `go test ./... -v` 全量通过；观察 `/metrics` 输出与日志。
- 容器：`docker-compose up -d` 后配置环境变量，服务端选择 `pg` 与 `rabbit`，客户端端到端提交成功并统计入库、队列消费正常。